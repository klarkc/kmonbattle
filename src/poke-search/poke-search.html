<html><head><link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/paper-dialog/paper-dialog.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../bower_components/neon-animation/animations/scale-up-animation.html">
<link rel="import" href="../../bower_components/neon-animation/animations/fade-out-animation.html">

<link rel="import" href="../poke-list/poke-list.html">

<link rel="import" href="../shared-styles.html">

</head><body><dom-module id="poke-search">
  <template>
    <style include="shared-styles">
      :host {
        display: flex;
        flex-direction: column;
      }
    </style>
    <paper-dialog entry-animation="scale-up-animation" exit-animation="fade-out-animation" id="dialog">
      <h2>Please, select {{person}} pokemons</h2>
      <poke-list id="pokeList" poke-index="{{pokeIndex}}" selected="{{selectedPokes}}" selectable=""></poke-list>
      <div class="buttons">
        <paper-button dialog-confirm="" autofocus="" on-tap="_setPokes">Accept</paper-button>
      </div>
    </paper-dialog>
  </template>

  <script>Polymer({is:"poke-search",properties:{apiUrl:{type:String,value:"https://pokeapi.co/api/v2"},pokemons:{type:Object,notify:!0,value:function(){return{enemy:[],player:[]}}},pokeIndex:{type:Array,notify:!0,readOnly:!0,value:function(){return[]}}},listeners:{"dialog.opened-changed":"_checkDone","pokeList.selected-changed":"_refreshDialog"},observers:["_loadPokeIndex(apiUrl)"],_refreshDialog:function(){this.$.dialog.refit(),this.$.dialog.center()},open:function(e){this.selectedPokes=[],this.person=e||"ENEMY",this.$.dialog.open()},_setPokes:function(){this.selectedPokes&&("ENEMY"===this.person&&this.set("pokemons.enemy",this.selectedPokes),"PLAYER"===this.person&&this.set("pokemons.player",this.selectedPokes))},_checkDone:function(){if(this.pokemons)return this.pokemons.enemy.length<1?void this.open("ENEMY"):this.pokemons.player.length<1?void this.open("PLAYER"):void this.fire("pokemons-ready")},_loadPokeIndex:function(){var e=new XMLHttpRequest;e.onload=function(){this._setPokeIndex(JSON.parse(e.response).results)}.bind(this),e.open("GET",this.apiUrl+"/pokemon/?limit=151"),e.send()}});</script>
</dom-module>
</body></html>