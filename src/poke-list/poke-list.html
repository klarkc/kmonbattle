<link rel="import" href="../../bower_components/polymer/polymer.html">

<link rel="import" href="../shared-styles.html">

<dom-module id="poke-list">
  <template>
    <style include="shared-styles"></style>
    Selected [[_getSelectedCount(selected)]] random pokemons
  </template>

  <script>
    Polymer({
      is: 'poke-list',
      properties: {
        pokeIndex: Object,
        selected: {
          type: Array,
          readOnly: true,
          notify: true
        },
        selectable: {
          type: Boolean,
          value: false
        }
      },
      observers: [
        '_previewPick(pokeIndex)'
      ],
      _getSelectedCoutn: function(selected) {
        return selected.length;
      },
      _previewPick: function() {
        //pick 6 random pokemons
        for(var i = 0; i<6; i++) {
          var index = Math.floor(Math.random() * 151);
          this._sendPokeRequest(this.pokeIndex[index]);
        }
      },
      _sendPokeRequest: function(pokeIndex) {
        var req = new XMLHttpRequest();
        req.onload = function() {
          this.push('selected', JSON.parse(req.response));
        }.bind(this);
        req.open('GET', pokeIndex.url);
        req.send();
      }
    });
  </script>
</dom-module>
